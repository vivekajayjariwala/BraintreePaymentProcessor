{"ast":null,"code":"\"use strict\";\n\nlet Buffer = require(\"buffer\").Buffer;\nlet Digest = require(\"./digest\").Digest;\nlet Gateway = require(\"./gateway\").Gateway;\nlet WebhookNotification = require(\"./webhook_notification\").WebhookNotification;\nlet dateFormat = require(\"dateformat\");\nlet wrapPrototype = require(\"@braintree/wrap-promise\").wrapPrototype;\nclass WebhookTestingGateway extends Gateway {\n  constructor(gateway) {\n    super();\n    this.gateway = gateway;\n    this.config = this.gateway.config;\n  }\n  sampleNotification(kind, id, sourceMerchantId) {\n    const xml = this.sampleXml(kind, id, sourceMerchantId);\n    const payload = Buffer.from(xml).toString(\"base64\") + \"\\n\";\n    const signature = this.sampleSignature(payload);\n    return {\n      bt_signature: signature,\n      // eslint-disable-line camelcase\n      bt_payload: payload // eslint-disable-line camelcase\n    };\n  }\n\n  sampleSignature(payload) {\n    return `${this.gateway.config.publicKey}|${Digest.Sha1hexdigest(this.gateway.config.privateKey, payload)}`;\n  }\n  sampleXml(kind, id, sourceMerchantId) {\n    let sourceMerchantIdXml = \"\";\n    if (sourceMerchantId) {\n      sourceMerchantIdXml = `<source-merchant-id>${sourceMerchantId}</source-merchant-id>`;\n    }\n    return `<notification>\n    <timestamp type=\"datetime\">${dateFormat(new Date(), dateFormat.masks.isoUtcDateTime, true)}</timestamp>\n    <kind>${kind}</kind>\n    ${sourceMerchantIdXml}\n    <subject>${this.subjectXmlFor(kind, id)}</subject>\n</notification>`;\n  }\n\n  // eslint-disable-next-line complexity\n  subjectXmlFor(kind, id) {\n    switch (kind) {\n      case WebhookNotification.Kind.AccountUpdaterDailyReport:\n        return this.subjectXmlForAccountUpdaterDailyReport();\n      case WebhookNotification.Kind.Check:\n        return this.subjectXmlForCheck();\n      case WebhookNotification.Kind.ConnectedMerchantPayPalStatusChanged:\n        return this.subjectXmlForConnectedMerchantPayPalStatusChanged(id);\n      case WebhookNotification.Kind.ConnectedMerchantStatusTransitioned:\n        return this.subjectXmlForConnectedMerchantStatusTransitioned(id);\n      case WebhookNotification.Kind.Disbursement:\n        return this.subjectXmlForDisbursement(id);\n      case WebhookNotification.Kind.DisbursementException:\n        return this.subjectXmlForDisbursementException(id);\n      case WebhookNotification.Kind.DisputeAccepted:\n        return this.subjectXmlForDisputeAccepted(id);\n      case WebhookNotification.Kind.DisputeAutoAccepted:\n        return this.subjectXmlForDisputeAutoAccepted(id);\n      case WebhookNotification.Kind.DisputeDisputed:\n        return this.subjectXmlForDisputeDisputed(id);\n      case WebhookNotification.Kind.DisputeExpired:\n        return this.subjectXmlForDisputeExpired(id);\n      case WebhookNotification.Kind.DisputeLost:\n        return this.subjectXmlForDisputeLost(id);\n      case WebhookNotification.Kind.DisputeOpened:\n        return this.subjectXmlForDisputeOpened(id);\n      case WebhookNotification.Kind.DisputeWon:\n        return this.subjectXmlForDisputeWon(id);\n      case WebhookNotification.Kind.GrantedPaymentMethodRevoked:\n        return this.subjectXmlForGrantedPaymentMethodRevoked(id);\n      case WebhookNotification.Kind.GrantorUpdatedGrantedPaymentMethod:\n        return this.subjectXmlForGrantedPaymentInstrumentUpdate();\n      case WebhookNotification.Kind.LocalPaymentCompleted:\n        return this.subjectXmlForLocalPaymentCompleted(id);\n      case WebhookNotification.Kind.LocalPaymentExpired:\n        return this.subjectXmlForLocalPaymentExpired(id);\n      case WebhookNotification.Kind.LocalPaymentFunded:\n        return this.subjectXmlForLocalPaymentFunded(id);\n      case WebhookNotification.Kind.LocalPaymentReversed:\n        return this.subjectXmlForLocalPaymentReversed(id);\n      case WebhookNotification.Kind.OAuthAccessRevoked:\n        return this.subjectXmlForOAuthAccessRevocation(id);\n      case WebhookNotification.Kind.PartnerMerchantConnected:\n        return this.subjectXmlForPartnerMerchantConnected();\n      case WebhookNotification.Kind.PartnerMerchantDeclined:\n        return this.subjectXmlForPartnerMerchantDeclined();\n      case WebhookNotification.Kind.PartnerMerchantDisconnected:\n        return this.subjectXmlForPartnerMerchantDisconnected();\n      case WebhookNotification.Kind.PaymentMethodCustomerDataUpdated:\n        return this.subjectXmlForPaymentMethodCustomerDataUpdated(id);\n      case WebhookNotification.Kind.PaymentMethodRevokedByCustomer:\n        return this.subjectXmlForPaymentMethodRevokedByCustomer(id);\n      case WebhookNotification.Kind.RecipientUpdatedGrantedPaymentMethod:\n        return this.subjectXmlForGrantedPaymentInstrumentUpdate();\n      case WebhookNotification.Kind.SubMerchantAccountApproved:\n        return this.subjectXmlForSubMerchantAccountApproved(id);\n      case WebhookNotification.Kind.SubMerchantAccountDeclined:\n        return this.subjectXmlForSubMerchantAccountDeclined(id);\n      case WebhookNotification.Kind.SubscriptionChargedSuccessfully:\n        return this.subjectXmlForSubscriptionChargedSuccessfully(id);\n      case WebhookNotification.Kind.SubscriptionChargedUnsuccessfully:\n        return this.subjectXmlForSubscriptionChargedUnsuccessfully(id);\n      case WebhookNotification.Kind.TransactionDisbursed:\n        return this.subjectXmlForTransactionDisbursed(id);\n      case WebhookNotification.Kind.TransactionReviewed:\n        return this.subjectXmlForTransactionReviewed(id);\n      case WebhookNotification.Kind.TransactionSettled:\n        return this.subjectXmlForTransactionSettled(id);\n      case WebhookNotification.Kind.TransactionSettlementDeclined:\n        return this.subjectXmlForTransactionSettlementDeclined(id);\n      default:\n        return this.subjectXmlForSubscription(id);\n    }\n  }\n  subjectXmlForAccountUpdaterDailyReport() {\n    return `<account-updater-daily-report>\n  <report-date type=\"date\">2016-01-14</report-date>\n  <report-url>link-to-csv-report</report-url>\n</account-updater-daily-report>`;\n  }\n  subjectXmlForCheck() {\n    return '<check type=\"boolean\">true</check>';\n  }\n  subjectXmlForTransactionDisbursed(id) {\n    return `<transaction>\n  <id>${id}</id>\n  <amount>100</amount>\n  <disbursement-details>\n    <disbursement-date type=\"datetime\">2013-07-09T18:23:29Z</disbursement-date>\n  </disbursement-details>\n</transaction>`;\n  }\n  subjectXmlForTransactionReviewed(id) {\n    return `<transaction-review>\n  <transaction-id>${id}</transaction-id>\n  <decision>a smart decision</decision>\n  <reviewer-email>hey@girl.com</reviewer-email>\n  <reviewer-note>I reviewed this</reviewer-note>\n  <reviewed-time type=\"datetime\">2021-04-20T06:09:00Z</reviewed-time>\n</transaction-review>`;\n  }\n  subjectXmlForTransactionSettled(id) {\n    return `<transaction>\n  <id>${id}</id>\n  <status>settled</status>\n  <type>sale</type>\n  <currency-iso-code>USD</currency-iso-code>\n  <amount>100</amount>\n  <merchant-account-id>ogaotkivejpfayqfeaimuktty</merchant-account-id>\n  <payment-instrument-type>us_bank_account</payment-instrument-type>\n  <us-bank-account>\n    <routing-number>123456789</routing-number>\n    <last-4>1234</last-4>\n    <account-type>checking</account-type>\n    <account-holder-name>Dan Schulman</account-holder-name>\n  </us-bank-account>\n</transaction>`;\n  }\n  subjectXmlForTransactionSettlementDeclined(id) {\n    return `<transaction>\n  <id>${id}</id>\n  <status>settlement_declined</status>\n  <type>sale</type>\n  <currency-iso-code>USD</currency-iso-code>\n  <amount>100</amount>\n  <merchant-account-id>ogaotkivejpfayqfeaimuktty</merchant-account-id>\n  <payment-instrument-type>us_bank_account</payment-instrument-type>\n  <us-bank-account>\n    <routing-number>123456789</routing-number>\n    <last-4>1234</last-4>\n    <account-type>checking</account-type>\n    <account-holder-name>Dan Schulman</account-holder-name>\n  </us-bank-account>\n</transaction>`;\n  }\n  subjectXmlForDisputeOpened(id) {\n    return `<dispute>\n  <amount>250.00</amount>\n  <amount-disputed>250.0</amount-disputed>\n  <amount-won>245.00</amount-won>\n  <currency-iso-code>USD</currency-iso-code>\n  <received-date type=\"date\">2014-03-01</received-date>\n  <reply-by-date type=\"date\">2014-03-21</reply-by-date>\n  <kind>chargeback</kind>\n  <status>open</status>\n  <reason>fraud</reason>\n  <id>${id}</id>\n  <transaction>\n    <id>${id}</id>\n    <amount>250.00</amount>\n  </transaction>\n  <date-opened type=\"date\">2014-03-28</date-opened>\n</dispute>`;\n  }\n  subjectXmlForDisputeLost(id) {\n    return `<dispute>\n  <amount>250.00</amount>\n  <amount-disputed>250.0</amount-disputed>\n  <amount-won>245.00</amount-won>\n  <currency-iso-code>USD</currency-iso-code>\n  <received-date type=\"date\">2014-03-01</received-date>\n  <reply-by-date type=\"date\">2014-03-21</reply-by-date>\n  <kind>chargeback</kind>\n  <status>lost</status>\n  <reason>fraud</reason>\n  <id>${id}</id>\n  <transaction>\n    <id>${id}</id>\n    <amount>250.00</amount>\n  </transaction>\n  <date-opened type=\"date\">2014-03-28</date-opened>\n</dispute>`;\n  }\n  subjectXmlForDisputeWon(id) {\n    return `<dispute>\n  <amount>250.00</amount>\n  <amount-disputed>250.0</amount-disputed>\n  <amount-won>245.00</amount-won>\n  <currency-iso-code>USD</currency-iso-code>\n  <received-date type=\"date\">2014-03-01</received-date>\n  <reply-by-date type=\"date\">2014-03-21</reply-by-date>\n  <kind>chargeback</kind>\n  <status>won</status>\n  <reason>fraud</reason>\n  <id>${id}</id>\n  <transaction>\n    <id>${id}</id>\n    <amount>250.00</amount>\n  </transaction>\n  <date-opened type=\"date\">2014-03-28</date-opened>\n  <date-won type=\"date\">2014-09-01</date-won>\n</dispute>`;\n  }\n  subjectXmlForDisputeAccepted(id) {\n    return `<dispute>\n  <amount>250.00</amount>\n  <amount-disputed>250.0</amount-disputed>\n  <amount-won>245.00</amount-won>\n  <currency-iso-code>USD</currency-iso-code>\n  <received-date type=\"date\">2014-03-01</received-date>\n  <reply-by-date type=\"date\">2014-03-21</reply-by-date>\n  <kind>chargeback</kind>\n  <status>accepted</status>\n  <reason>fraud</reason>\n  <id>${id}</id>\n  <transaction>\n    <id>${id}</id>\n    <amount>250.00</amount>\n  </transaction>\n  <date-opened type=\"date\">2014-03-28</date-opened>\n</dispute>`;\n  }\n  subjectXmlForDisputeAutoAccepted(id) {\n    return `<dispute>\n  <amount>250.00</amount>\n  <amount-disputed>250.0</amount-disputed>\n  <amount-won>245.00</amount-won>\n  <currency-iso-code>USD</currency-iso-code>\n  <received-date type=\"date\">2014-03-01</received-date>\n  <reply-by-date type=\"date\">2014-03-21</reply-by-date>\n  <kind>chargeback</kind>\n  <status>auto_accepted</status>\n  <reason>fraud</reason>\n  <id>${id}</id>\n  <transaction>\n    <id>${id}</id>\n    <amount>250.00</amount>\n  </transaction>\n  <date-opened type=\"date\">2014-03-28</date-opened>\n</dispute>`;\n  }\n  subjectXmlForDisputeDisputed(id) {\n    return `<dispute>\n  <amount>250.00</amount>\n  <amount-disputed>250.0</amount-disputed>\n  <amount-won>245.00</amount-won>\n  <currency-iso-code>USD</currency-iso-code>\n  <received-date type=\"date\">2014-03-01</received-date>\n  <reply-by-date type=\"date\">2014-03-21</reply-by-date>\n  <kind>chargeback</kind>\n  <status>disputed</status>\n  <reason>fraud</reason>\n  <id>${id}</id>\n  <transaction>\n    <id>${id}</id>\n    <amount>250.00</amount>\n  </transaction>\n  <date-opened type=\"date\">2014-03-28</date-opened>\n</dispute>`;\n  }\n  subjectXmlForDisputeExpired(id) {\n    return `<dispute>\n  <amount>250.00</amount>\n  <amount-disputed>250.0</amount-disputed>\n  <amount-won>245.00</amount-won>\n  <currency-iso-code>USD</currency-iso-code>\n  <received-date type=\"date\">2014-03-01</received-date>\n  <reply-by-date type=\"date\">2014-03-21</reply-by-date>\n  <kind>chargeback</kind>\n  <status>expired</status>\n  <reason>fraud</reason>\n  <id>${id}</id>\n  <transaction>\n    <id>${id}</id>\n    <amount>250.00</amount>\n  </transaction>\n  <date-opened type=\"date\">2014-03-28</date-opened>\n</dispute>`;\n  }\n  subjectXmlForDisbursementException(id) {\n    return `<disbursement>\n  <id>${id}</id>\n  <transaction-ids type=\"array\">\n    <item>afv56j</item>\n    <item>kj8hjk</item>\n  </transaction-ids>\n  <success type=\"boolean\">false</success>\n  <retry type=\"boolean\">false</retry>\n  <merchant-account>\n    <id>merchant_account_token</id>\n    <currency-iso-code>USD</currency-iso-code>\n    <sub-merchant-account type=\"boolean\">false</sub-merchant-account>\n    <status>active</status>\n  </merchant-account>\n  <amount>100.00</amount>\n  <disbursement-date type=\"date\">2014-02-10</disbursement-date>\n  <exception-message>bank_rejected</exception-message>\n  <follow-up-action>update_funding_information</follow-up-action>\n</disbursement>`;\n  }\n  subjectXmlForDisbursement(id) {\n    return `<disbursement>\n  <id>${id}</id>\n  <transaction-ids type=\"array\">\n    <item>afv56j</item>\n    <item>kj8hjk</item>\n  </transaction-ids>\n  <success type=\"boolean\">true</success>\n  <retry type=\"boolean\">false</retry>\n  <merchant-account>\n    <id>merchant_account_token</id>\n    <currency-iso-code>USD</currency-iso-code>\n    <sub-merchant-account type=\"boolean\">false</sub-merchant-account>\n    <status>active</status>\n  </merchant-account>\n  <amount>100.00</amount>\n  <disbursement-date type=\"date\">2014-02-10</disbursement-date>\n  <exception-message nil=\"true\"/>\n  <follow-up-action nil=\"true\"/>\n</disbursement>`;\n  }\n  subjectXmlForGrantedPaymentInstrumentUpdate() {\n    return `<granted-payment-instrument-update>\n    <grant-owner-merchant-id>vczo7jqrpwrsi2px</grant-owner-merchant-id>\n    <grant-recipient-merchant-id>cf0i8wgarszuy6hc</grant-recipient-merchant-id>\n    <payment-method-nonce>\n      <nonce>ee257d98-de40-47e8-96b3-a6954ea7a9a4</nonce>\n      <consumed type=\"boolean\">false</consumed>\n      <locked type=\"boolean\">false</locked>\n    </payment-method-nonce>\n    <token>abc123z</token>\n    <updated-fields type=\"array\">\n      <item>expiration-month</item>\n      <item>expiration-year</item>\n    </updated-fields>\n  </granted-payment-instrument-update>`;\n  }\n  subjectXmlForSubMerchantAccountApproved(id) {\n    return `<merchant_account>\n  <id>${id}</id>\n</merchant_account>`;\n  }\n  errorSampleXml() {\n    return `<error>\n  <code>82621</code>\n  <message>Credit score is too low</message>\n  <attribute type=\\\"symbol\\\">base</attribute>\n</error>`;\n  }\n  subjectXmlForSubMerchantAccountDeclined(id) {\n    return `<api-error-response>\n  <message>Credit score is too low</message>\n  <errors>\n    <merchant-account>\n      <errors type=\"array\">\n        ${this.errorSampleXml()}\n      </errors>\n    </merchant-account>\n  </errors>\n  ${this.merchantAccountSampleXml(id)}\n</api-error-response>`;\n  }\n  merchantAccountSampleXml(id) {\n    return `<merchant_account>\n  <id>${id}</id>\n  <master_merchant_account>\n    <id>master_ma_for_${id}</id>\n    <status>suspended</status>\n  </master_merchant_account>\n  <status>suspended</status>\n</merchant_account>`;\n  }\n  subjectXmlForSubscription(id) {\n    return `<subscription>\n    <id>${id}</id>\n    <transactions type=\"array\"></transactions>\n    <add_ons type=\"array\"></add_ons>\n    <discounts type=\"array\"></discounts>\n</subscription>`;\n  }\n  subjectXmlForSubscriptionChargedSuccessfully(id) {\n    return `<subscription>\n    <id>${id}</id>\n    <transactions type=\"array\">\n      <transaction>\n        <id>${id}</id>\n        <status>submitted_for_settlement</status>\n        <amount>49.99</amount>\n      </transaction>\n    </transactions>\n    <add_ons type=\"array\"></add_ons>\n    <discounts type=\"array\"></discounts>\n</subscription>`;\n  }\n  subjectXmlForSubscriptionChargedUnsuccessfully(id) {\n    return `<subscription>\n    <id>${id}</id>\n    <transactions type=\"array\">\n      <transaction>\n        <id>${id}</id>\n        <status>failed</status>\n        <amount>49.99</amount>\n      </transaction>\n    </transactions>\n    <add_ons type=\"array\"></add_ons>\n    <discounts type=\"array\"></discounts>\n</subscription>`;\n  }\n  subjectXmlForGrantedPaymentMethodRevoked(id) {\n    return this._venmoAccountXml(id);\n  }\n  subjectXmlForPartnerMerchantConnected() {\n    return `<partner-merchant>\n  <merchant-public-id>public_id</merchant-public-id>\n  <public-key>public_key</public-key>\n  <private-key>private_key</private-key>\n  <partner-merchant-id>abc123</partner-merchant-id>\n  <client-side-encryption-key>cse_key</client-side-encryption-key>\n</partner-merchant>`;\n  }\n  subjectXmlForPartnerMerchantDisconnected() {\n    return `<partner-merchant>\n  <partner-merchant-id>abc123</partner-merchant-id>\n</partner-merchant>`;\n  }\n  subjectXmlForConnectedMerchantStatusTransitioned(id) {\n    return `<connected-merchant-status-transitioned>\n        <merchant-public-id>${id}</merchant-public-id>\n        <status>new_status</status>\n        <oauth-application-client-id>oauth_application_client_id</oauth-application-client-id>\n      </connected-merchant-status-transitioned>`;\n  }\n  subjectXmlForConnectedMerchantPayPalStatusChanged(id) {\n    return `<connected-merchant-paypal-status-changed>\n        <merchant-public-id>${id}</merchant-public-id>\n        <action>link</action>\n        <oauth-application-client-id>oauth_application_client_id</oauth-application-client-id>\n      </connected-merchant-paypal-status-changed>`;\n  }\n  subjectXmlForPartnerMerchantDeclined() {\n    return `<partner-merchant>\n  <partner-merchant-id>abc123</partner-merchant-id>\n</partner-merchant>`;\n  }\n  subjectXmlForOAuthAccessRevocation(id) {\n    return `<oauth-application-revocation>\n      <merchant-id>${id}</merchant-id>\n      <oauth-application-client-id>oauth_application_client_id</oauth-application-client-id>\n    </oauth-application-revocation>`;\n  }\n  subjectXmlForPaymentMethodRevokedByCustomer(id) {\n    return `<paypal-account>\n      <billing-agreement-id>a-billing-agreement-id</billing-agreement-id>\n      <created-at type=\"datetime\">2019-01-01T12:00:00Z</created-at>\n      <customer-id>a-customer-id</customer-id>\n      <default type=\"boolean\">true</default>\n      <email>name@email.com</email>\n      <global-id>cGF5bWVudG1ldGhvZF9jaDZieXNz</global-id>\n      <image-url>https://assets.braintreegateway.com/payment_method_logo/paypal.png?environment=test</image-url>\n      <subscriptions type=\"array\"/>\n      <token>${id}</token>\n      <updated-at type=\"datetime\">2019-01-02T12:00:00Z</updated-at>\n      <is-channel-initiated nil=\"true\"/>\n      <payer-id>a-payer-id</payer-id>\n      <payer-info nil=\"true\"/>\n      <limited-use-order-id nil=\"true\"/>\n      <revoked-at type=\"datetime\">2019-01-02T12:00:00Z</revoked-at>\n    </paypal-account>`;\n  }\n  subjectXmlForLocalPaymentCompleted() {\n    return `<local-payment>\n      <payment-id>a-payment-id</payment-id>\n      <payer-id>a-payer-id</payer-id>\n      <payment-method-nonce>ee257d98-de40-47e8-96b3-a6954ea7a9a4</payment-method-nonce>\n      <transaction>\n        <id>1</id>\n        <status>authorizing</status>\n        <amount>10.00</amount>\n        <order-id>order1234</order-id>\n      </transaction>\n    </local-payment>`;\n  }\n  subjectXmlForLocalPaymentExpired() {\n    return `<local-payment-expired>\n      <payment-id>a-payment-id</payment-id>\n      <payment-context-id>a-payment-context-id</payment-context-id>\n    </local-payment-expired>`;\n  }\n  subjectXmlForLocalPaymentFunded() {\n    return `<local-payment-funded>\n      <payment-id>a-payment-id</payment-id>\n      <payment-context-id>a-payment-context-id</payment-context-id>\n      <transaction>\n        <id>1</id>\n        <status>settled</status>\n        <amount>10.00</amount>\n        <order-id>order1234</order-id>\n      </transaction>\n    </local-payment-funded>`;\n  }\n  subjectXmlForLocalPaymentReversed() {\n    return `<local-payment-reversed>\n      <payment-id>a-payment-id</payment-id>\n    </local-payment-reversed>`;\n  }\n  subjectXmlForPaymentMethodCustomerDataUpdated(id) {\n    return `<payment-method-customer-data-updated-metadata>\n      <token>TOKEN-12345</token>\n      <payment-method>\n        ${this._venmoAccountXml(id)}\n      </payment-method>\n      <datetime-updated type='dateTime'>2022-01-01T21:28:37Z</datetime-updated>\n      <enriched-customer-data>\n        <fields-updated type='array'>\n          <item>username</item>\n        </fields-updated>\n        <profile-data>\n          <username>venmo_username</username>\n          <first-name>John</first-name>\n          <last-name>Doe</last-name>\n          <phone-number>1231231234</phone-number>\n          <email>john.doe@paypal.com</email>\n        </profile-data>\n      </enriched-customer-data>\n    </payment-method-customer-data-updated-metadata>`;\n  }\n  _venmoAccountXml(id) {\n    return `<venmo-account>\n      <default type=\"boolean\">true</default>\n      <image-url>https://assets.braintreegateway.com/payment_method_logo/venmo.png?environment=test</image-url>\n      <token>${id}</token>\n      <source-description>Venmo Account: venmojoe</source-description>\n      <username>venmojoe</username>\n      <venmo-user-id>456</venmo-user-id>\n      <subscriptions type=\"array\"/>\n      <customer-id>venmo_customer_id</customer-id>\n      <global-id>cGF5bWVudG1ldGhvZF92ZW5tb2FjY291bnQ</global-id>\n    </venmo-account>`;\n  }\n}\nmodule.exports = {\n  WebhookTestingGateway: wrapPrototype(WebhookTestingGateway)\n};","map":{"version":3,"names":["Buffer","require","Digest","Gateway","WebhookNotification","dateFormat","wrapPrototype","WebhookTestingGateway","constructor","gateway","config","sampleNotification","kind","id","sourceMerchantId","xml","sampleXml","payload","from","toString","signature","sampleSignature","bt_signature","bt_payload","publicKey","Sha1hexdigest","privateKey","sourceMerchantIdXml","Date","masks","isoUtcDateTime","subjectXmlFor","Kind","AccountUpdaterDailyReport","subjectXmlForAccountUpdaterDailyReport","Check","subjectXmlForCheck","ConnectedMerchantPayPalStatusChanged","subjectXmlForConnectedMerchantPayPalStatusChanged","ConnectedMerchantStatusTransitioned","subjectXmlForConnectedMerchantStatusTransitioned","Disbursement","subjectXmlForDisbursement","DisbursementException","subjectXmlForDisbursementException","DisputeAccepted","subjectXmlForDisputeAccepted","DisputeAutoAccepted","subjectXmlForDisputeAutoAccepted","DisputeDisputed","subjectXmlForDisputeDisputed","DisputeExpired","subjectXmlForDisputeExpired","DisputeLost","subjectXmlForDisputeLost","DisputeOpened","subjectXmlForDisputeOpened","DisputeWon","subjectXmlForDisputeWon","GrantedPaymentMethodRevoked","subjectXmlForGrantedPaymentMethodRevoked","GrantorUpdatedGrantedPaymentMethod","subjectXmlForGrantedPaymentInstrumentUpdate","LocalPaymentCompleted","subjectXmlForLocalPaymentCompleted","LocalPaymentExpired","subjectXmlForLocalPaymentExpired","LocalPaymentFunded","subjectXmlForLocalPaymentFunded","LocalPaymentReversed","subjectXmlForLocalPaymentReversed","OAuthAccessRevoked","subjectXmlForOAuthAccessRevocation","PartnerMerchantConnected","subjectXmlForPartnerMerchantConnected","PartnerMerchantDeclined","subjectXmlForPartnerMerchantDeclined","PartnerMerchantDisconnected","subjectXmlForPartnerMerchantDisconnected","PaymentMethodCustomerDataUpdated","subjectXmlForPaymentMethodCustomerDataUpdated","PaymentMethodRevokedByCustomer","subjectXmlForPaymentMethodRevokedByCustomer","RecipientUpdatedGrantedPaymentMethod","SubMerchantAccountApproved","subjectXmlForSubMerchantAccountApproved","SubMerchantAccountDeclined","subjectXmlForSubMerchantAccountDeclined","SubscriptionChargedSuccessfully","subjectXmlForSubscriptionChargedSuccessfully","SubscriptionChargedUnsuccessfully","subjectXmlForSubscriptionChargedUnsuccessfully","TransactionDisbursed","subjectXmlForTransactionDisbursed","TransactionReviewed","subjectXmlForTransactionReviewed","TransactionSettled","subjectXmlForTransactionSettled","TransactionSettlementDeclined","subjectXmlForTransactionSettlementDeclined","subjectXmlForSubscription","errorSampleXml","merchantAccountSampleXml","_venmoAccountXml","module","exports"],"sources":["C:/Users/Vivek Jariwala/Documents/AngularProjects/BraintreePaymentProcessor/node_modules/braintree/lib/braintree/webhook_testing_gateway.js"],"sourcesContent":["\"use strict\";\n\nlet Buffer = require(\"buffer\").Buffer;\nlet Digest = require(\"./digest\").Digest;\nlet Gateway = require(\"./gateway\").Gateway;\nlet WebhookNotification = require(\"./webhook_notification\").WebhookNotification;\nlet dateFormat = require(\"dateformat\");\nlet wrapPrototype = require(\"@braintree/wrap-promise\").wrapPrototype;\n\nclass WebhookTestingGateway extends Gateway {\n  constructor(gateway) {\n    super();\n    this.gateway = gateway;\n    this.config = this.gateway.config;\n  }\n\n  sampleNotification(kind, id, sourceMerchantId) {\n    const xml = this.sampleXml(kind, id, sourceMerchantId);\n    const payload = Buffer.from(xml).toString(\"base64\") + \"\\n\";\n    const signature = this.sampleSignature(payload);\n\n    return {\n      bt_signature: signature, // eslint-disable-line camelcase\n      bt_payload: payload, // eslint-disable-line camelcase\n    };\n  }\n\n  sampleSignature(payload) {\n    return `${this.gateway.config.publicKey}|${Digest.Sha1hexdigest(\n      this.gateway.config.privateKey,\n      payload\n    )}`;\n  }\n\n  sampleXml(kind, id, sourceMerchantId) {\n    let sourceMerchantIdXml = \"\";\n\n    if (sourceMerchantId) {\n      sourceMerchantIdXml = `<source-merchant-id>${sourceMerchantId}</source-merchant-id>`;\n    }\n\n    return `<notification>\n    <timestamp type=\"datetime\">${dateFormat(\n      new Date(),\n      dateFormat.masks.isoUtcDateTime,\n      true\n    )}</timestamp>\n    <kind>${kind}</kind>\n    ${sourceMerchantIdXml}\n    <subject>${this.subjectXmlFor(kind, id)}</subject>\n</notification>`;\n  }\n\n  // eslint-disable-next-line complexity\n  subjectXmlFor(kind, id) {\n    switch (kind) {\n      case WebhookNotification.Kind.AccountUpdaterDailyReport:\n        return this.subjectXmlForAccountUpdaterDailyReport();\n      case WebhookNotification.Kind.Check:\n        return this.subjectXmlForCheck();\n      case WebhookNotification.Kind.ConnectedMerchantPayPalStatusChanged:\n        return this.subjectXmlForConnectedMerchantPayPalStatusChanged(id);\n      case WebhookNotification.Kind.ConnectedMerchantStatusTransitioned:\n        return this.subjectXmlForConnectedMerchantStatusTransitioned(id);\n      case WebhookNotification.Kind.Disbursement:\n        return this.subjectXmlForDisbursement(id);\n      case WebhookNotification.Kind.DisbursementException:\n        return this.subjectXmlForDisbursementException(id);\n      case WebhookNotification.Kind.DisputeAccepted:\n        return this.subjectXmlForDisputeAccepted(id);\n      case WebhookNotification.Kind.DisputeAutoAccepted:\n        return this.subjectXmlForDisputeAutoAccepted(id);\n      case WebhookNotification.Kind.DisputeDisputed:\n        return this.subjectXmlForDisputeDisputed(id);\n      case WebhookNotification.Kind.DisputeExpired:\n        return this.subjectXmlForDisputeExpired(id);\n      case WebhookNotification.Kind.DisputeLost:\n        return this.subjectXmlForDisputeLost(id);\n      case WebhookNotification.Kind.DisputeOpened:\n        return this.subjectXmlForDisputeOpened(id);\n      case WebhookNotification.Kind.DisputeWon:\n        return this.subjectXmlForDisputeWon(id);\n      case WebhookNotification.Kind.GrantedPaymentMethodRevoked:\n        return this.subjectXmlForGrantedPaymentMethodRevoked(id);\n      case WebhookNotification.Kind.GrantorUpdatedGrantedPaymentMethod:\n        return this.subjectXmlForGrantedPaymentInstrumentUpdate();\n      case WebhookNotification.Kind.LocalPaymentCompleted:\n        return this.subjectXmlForLocalPaymentCompleted(id);\n      case WebhookNotification.Kind.LocalPaymentExpired:\n        return this.subjectXmlForLocalPaymentExpired(id);\n      case WebhookNotification.Kind.LocalPaymentFunded:\n        return this.subjectXmlForLocalPaymentFunded(id);\n      case WebhookNotification.Kind.LocalPaymentReversed:\n        return this.subjectXmlForLocalPaymentReversed(id);\n      case WebhookNotification.Kind.OAuthAccessRevoked:\n        return this.subjectXmlForOAuthAccessRevocation(id);\n      case WebhookNotification.Kind.PartnerMerchantConnected:\n        return this.subjectXmlForPartnerMerchantConnected();\n      case WebhookNotification.Kind.PartnerMerchantDeclined:\n        return this.subjectXmlForPartnerMerchantDeclined();\n      case WebhookNotification.Kind.PartnerMerchantDisconnected:\n        return this.subjectXmlForPartnerMerchantDisconnected();\n      case WebhookNotification.Kind.PaymentMethodCustomerDataUpdated:\n        return this.subjectXmlForPaymentMethodCustomerDataUpdated(id);\n      case WebhookNotification.Kind.PaymentMethodRevokedByCustomer:\n        return this.subjectXmlForPaymentMethodRevokedByCustomer(id);\n      case WebhookNotification.Kind.RecipientUpdatedGrantedPaymentMethod:\n        return this.subjectXmlForGrantedPaymentInstrumentUpdate();\n      case WebhookNotification.Kind.SubMerchantAccountApproved:\n        return this.subjectXmlForSubMerchantAccountApproved(id);\n      case WebhookNotification.Kind.SubMerchantAccountDeclined:\n        return this.subjectXmlForSubMerchantAccountDeclined(id);\n      case WebhookNotification.Kind.SubscriptionChargedSuccessfully:\n        return this.subjectXmlForSubscriptionChargedSuccessfully(id);\n      case WebhookNotification.Kind.SubscriptionChargedUnsuccessfully:\n        return this.subjectXmlForSubscriptionChargedUnsuccessfully(id);\n      case WebhookNotification.Kind.TransactionDisbursed:\n        return this.subjectXmlForTransactionDisbursed(id);\n      case WebhookNotification.Kind.TransactionReviewed:\n        return this.subjectXmlForTransactionReviewed(id);\n      case WebhookNotification.Kind.TransactionSettled:\n        return this.subjectXmlForTransactionSettled(id);\n      case WebhookNotification.Kind.TransactionSettlementDeclined:\n        return this.subjectXmlForTransactionSettlementDeclined(id);\n      default:\n        return this.subjectXmlForSubscription(id);\n    }\n  }\n\n  subjectXmlForAccountUpdaterDailyReport() {\n    return `<account-updater-daily-report>\n  <report-date type=\"date\">2016-01-14</report-date>\n  <report-url>link-to-csv-report</report-url>\n</account-updater-daily-report>`;\n  }\n\n  subjectXmlForCheck() {\n    return '<check type=\"boolean\">true</check>';\n  }\n\n  subjectXmlForTransactionDisbursed(id) {\n    return `<transaction>\n  <id>${id}</id>\n  <amount>100</amount>\n  <disbursement-details>\n    <disbursement-date type=\"datetime\">2013-07-09T18:23:29Z</disbursement-date>\n  </disbursement-details>\n</transaction>`;\n  }\n\n  subjectXmlForTransactionReviewed(id) {\n    return `<transaction-review>\n  <transaction-id>${id}</transaction-id>\n  <decision>a smart decision</decision>\n  <reviewer-email>hey@girl.com</reviewer-email>\n  <reviewer-note>I reviewed this</reviewer-note>\n  <reviewed-time type=\"datetime\">2021-04-20T06:09:00Z</reviewed-time>\n</transaction-review>`;\n  }\n\n  subjectXmlForTransactionSettled(id) {\n    return `<transaction>\n  <id>${id}</id>\n  <status>settled</status>\n  <type>sale</type>\n  <currency-iso-code>USD</currency-iso-code>\n  <amount>100</amount>\n  <merchant-account-id>ogaotkivejpfayqfeaimuktty</merchant-account-id>\n  <payment-instrument-type>us_bank_account</payment-instrument-type>\n  <us-bank-account>\n    <routing-number>123456789</routing-number>\n    <last-4>1234</last-4>\n    <account-type>checking</account-type>\n    <account-holder-name>Dan Schulman</account-holder-name>\n  </us-bank-account>\n</transaction>`;\n  }\n\n  subjectXmlForTransactionSettlementDeclined(id) {\n    return `<transaction>\n  <id>${id}</id>\n  <status>settlement_declined</status>\n  <type>sale</type>\n  <currency-iso-code>USD</currency-iso-code>\n  <amount>100</amount>\n  <merchant-account-id>ogaotkivejpfayqfeaimuktty</merchant-account-id>\n  <payment-instrument-type>us_bank_account</payment-instrument-type>\n  <us-bank-account>\n    <routing-number>123456789</routing-number>\n    <last-4>1234</last-4>\n    <account-type>checking</account-type>\n    <account-holder-name>Dan Schulman</account-holder-name>\n  </us-bank-account>\n</transaction>`;\n  }\n\n  subjectXmlForDisputeOpened(id) {\n    return `<dispute>\n  <amount>250.00</amount>\n  <amount-disputed>250.0</amount-disputed>\n  <amount-won>245.00</amount-won>\n  <currency-iso-code>USD</currency-iso-code>\n  <received-date type=\"date\">2014-03-01</received-date>\n  <reply-by-date type=\"date\">2014-03-21</reply-by-date>\n  <kind>chargeback</kind>\n  <status>open</status>\n  <reason>fraud</reason>\n  <id>${id}</id>\n  <transaction>\n    <id>${id}</id>\n    <amount>250.00</amount>\n  </transaction>\n  <date-opened type=\"date\">2014-03-28</date-opened>\n</dispute>`;\n  }\n\n  subjectXmlForDisputeLost(id) {\n    return `<dispute>\n  <amount>250.00</amount>\n  <amount-disputed>250.0</amount-disputed>\n  <amount-won>245.00</amount-won>\n  <currency-iso-code>USD</currency-iso-code>\n  <received-date type=\"date\">2014-03-01</received-date>\n  <reply-by-date type=\"date\">2014-03-21</reply-by-date>\n  <kind>chargeback</kind>\n  <status>lost</status>\n  <reason>fraud</reason>\n  <id>${id}</id>\n  <transaction>\n    <id>${id}</id>\n    <amount>250.00</amount>\n  </transaction>\n  <date-opened type=\"date\">2014-03-28</date-opened>\n</dispute>`;\n  }\n\n  subjectXmlForDisputeWon(id) {\n    return `<dispute>\n  <amount>250.00</amount>\n  <amount-disputed>250.0</amount-disputed>\n  <amount-won>245.00</amount-won>\n  <currency-iso-code>USD</currency-iso-code>\n  <received-date type=\"date\">2014-03-01</received-date>\n  <reply-by-date type=\"date\">2014-03-21</reply-by-date>\n  <kind>chargeback</kind>\n  <status>won</status>\n  <reason>fraud</reason>\n  <id>${id}</id>\n  <transaction>\n    <id>${id}</id>\n    <amount>250.00</amount>\n  </transaction>\n  <date-opened type=\"date\">2014-03-28</date-opened>\n  <date-won type=\"date\">2014-09-01</date-won>\n</dispute>`;\n  }\n\n  subjectXmlForDisputeAccepted(id) {\n    return `<dispute>\n  <amount>250.00</amount>\n  <amount-disputed>250.0</amount-disputed>\n  <amount-won>245.00</amount-won>\n  <currency-iso-code>USD</currency-iso-code>\n  <received-date type=\"date\">2014-03-01</received-date>\n  <reply-by-date type=\"date\">2014-03-21</reply-by-date>\n  <kind>chargeback</kind>\n  <status>accepted</status>\n  <reason>fraud</reason>\n  <id>${id}</id>\n  <transaction>\n    <id>${id}</id>\n    <amount>250.00</amount>\n  </transaction>\n  <date-opened type=\"date\">2014-03-28</date-opened>\n</dispute>`;\n  }\n\n  subjectXmlForDisputeAutoAccepted(id) {\n    return `<dispute>\n  <amount>250.00</amount>\n  <amount-disputed>250.0</amount-disputed>\n  <amount-won>245.00</amount-won>\n  <currency-iso-code>USD</currency-iso-code>\n  <received-date type=\"date\">2014-03-01</received-date>\n  <reply-by-date type=\"date\">2014-03-21</reply-by-date>\n  <kind>chargeback</kind>\n  <status>auto_accepted</status>\n  <reason>fraud</reason>\n  <id>${id}</id>\n  <transaction>\n    <id>${id}</id>\n    <amount>250.00</amount>\n  </transaction>\n  <date-opened type=\"date\">2014-03-28</date-opened>\n</dispute>`;\n  }\n\n  subjectXmlForDisputeDisputed(id) {\n    return `<dispute>\n  <amount>250.00</amount>\n  <amount-disputed>250.0</amount-disputed>\n  <amount-won>245.00</amount-won>\n  <currency-iso-code>USD</currency-iso-code>\n  <received-date type=\"date\">2014-03-01</received-date>\n  <reply-by-date type=\"date\">2014-03-21</reply-by-date>\n  <kind>chargeback</kind>\n  <status>disputed</status>\n  <reason>fraud</reason>\n  <id>${id}</id>\n  <transaction>\n    <id>${id}</id>\n    <amount>250.00</amount>\n  </transaction>\n  <date-opened type=\"date\">2014-03-28</date-opened>\n</dispute>`;\n  }\n\n  subjectXmlForDisputeExpired(id) {\n    return `<dispute>\n  <amount>250.00</amount>\n  <amount-disputed>250.0</amount-disputed>\n  <amount-won>245.00</amount-won>\n  <currency-iso-code>USD</currency-iso-code>\n  <received-date type=\"date\">2014-03-01</received-date>\n  <reply-by-date type=\"date\">2014-03-21</reply-by-date>\n  <kind>chargeback</kind>\n  <status>expired</status>\n  <reason>fraud</reason>\n  <id>${id}</id>\n  <transaction>\n    <id>${id}</id>\n    <amount>250.00</amount>\n  </transaction>\n  <date-opened type=\"date\">2014-03-28</date-opened>\n</dispute>`;\n  }\n\n  subjectXmlForDisbursementException(id) {\n    return `<disbursement>\n  <id>${id}</id>\n  <transaction-ids type=\"array\">\n    <item>afv56j</item>\n    <item>kj8hjk</item>\n  </transaction-ids>\n  <success type=\"boolean\">false</success>\n  <retry type=\"boolean\">false</retry>\n  <merchant-account>\n    <id>merchant_account_token</id>\n    <currency-iso-code>USD</currency-iso-code>\n    <sub-merchant-account type=\"boolean\">false</sub-merchant-account>\n    <status>active</status>\n  </merchant-account>\n  <amount>100.00</amount>\n  <disbursement-date type=\"date\">2014-02-10</disbursement-date>\n  <exception-message>bank_rejected</exception-message>\n  <follow-up-action>update_funding_information</follow-up-action>\n</disbursement>`;\n  }\n\n  subjectXmlForDisbursement(id) {\n    return `<disbursement>\n  <id>${id}</id>\n  <transaction-ids type=\"array\">\n    <item>afv56j</item>\n    <item>kj8hjk</item>\n  </transaction-ids>\n  <success type=\"boolean\">true</success>\n  <retry type=\"boolean\">false</retry>\n  <merchant-account>\n    <id>merchant_account_token</id>\n    <currency-iso-code>USD</currency-iso-code>\n    <sub-merchant-account type=\"boolean\">false</sub-merchant-account>\n    <status>active</status>\n  </merchant-account>\n  <amount>100.00</amount>\n  <disbursement-date type=\"date\">2014-02-10</disbursement-date>\n  <exception-message nil=\"true\"/>\n  <follow-up-action nil=\"true\"/>\n</disbursement>`;\n  }\n\n  subjectXmlForGrantedPaymentInstrumentUpdate() {\n    return `<granted-payment-instrument-update>\n    <grant-owner-merchant-id>vczo7jqrpwrsi2px</grant-owner-merchant-id>\n    <grant-recipient-merchant-id>cf0i8wgarszuy6hc</grant-recipient-merchant-id>\n    <payment-method-nonce>\n      <nonce>ee257d98-de40-47e8-96b3-a6954ea7a9a4</nonce>\n      <consumed type=\"boolean\">false</consumed>\n      <locked type=\"boolean\">false</locked>\n    </payment-method-nonce>\n    <token>abc123z</token>\n    <updated-fields type=\"array\">\n      <item>expiration-month</item>\n      <item>expiration-year</item>\n    </updated-fields>\n  </granted-payment-instrument-update>`;\n  }\n\n  subjectXmlForSubMerchantAccountApproved(id) {\n    return `<merchant_account>\n  <id>${id}</id>\n</merchant_account>`;\n  }\n\n  errorSampleXml() {\n    return `<error>\n  <code>82621</code>\n  <message>Credit score is too low</message>\n  <attribute type=\\\"symbol\\\">base</attribute>\n</error>`;\n  }\n\n  subjectXmlForSubMerchantAccountDeclined(id) {\n    return `<api-error-response>\n  <message>Credit score is too low</message>\n  <errors>\n    <merchant-account>\n      <errors type=\"array\">\n        ${this.errorSampleXml()}\n      </errors>\n    </merchant-account>\n  </errors>\n  ${this.merchantAccountSampleXml(id)}\n</api-error-response>`;\n  }\n\n  merchantAccountSampleXml(id) {\n    return `<merchant_account>\n  <id>${id}</id>\n  <master_merchant_account>\n    <id>master_ma_for_${id}</id>\n    <status>suspended</status>\n  </master_merchant_account>\n  <status>suspended</status>\n</merchant_account>`;\n  }\n\n  subjectXmlForSubscription(id) {\n    return `<subscription>\n    <id>${id}</id>\n    <transactions type=\"array\"></transactions>\n    <add_ons type=\"array\"></add_ons>\n    <discounts type=\"array\"></discounts>\n</subscription>`;\n  }\n\n  subjectXmlForSubscriptionChargedSuccessfully(id) {\n    return `<subscription>\n    <id>${id}</id>\n    <transactions type=\"array\">\n      <transaction>\n        <id>${id}</id>\n        <status>submitted_for_settlement</status>\n        <amount>49.99</amount>\n      </transaction>\n    </transactions>\n    <add_ons type=\"array\"></add_ons>\n    <discounts type=\"array\"></discounts>\n</subscription>`;\n  }\n\n  subjectXmlForSubscriptionChargedUnsuccessfully(id) {\n    return `<subscription>\n    <id>${id}</id>\n    <transactions type=\"array\">\n      <transaction>\n        <id>${id}</id>\n        <status>failed</status>\n        <amount>49.99</amount>\n      </transaction>\n    </transactions>\n    <add_ons type=\"array\"></add_ons>\n    <discounts type=\"array\"></discounts>\n</subscription>`;\n  }\n\n  subjectXmlForGrantedPaymentMethodRevoked(id) {\n    return this._venmoAccountXml(id);\n  }\n\n  subjectXmlForPartnerMerchantConnected() {\n    return `<partner-merchant>\n  <merchant-public-id>public_id</merchant-public-id>\n  <public-key>public_key</public-key>\n  <private-key>private_key</private-key>\n  <partner-merchant-id>abc123</partner-merchant-id>\n  <client-side-encryption-key>cse_key</client-side-encryption-key>\n</partner-merchant>`;\n  }\n\n  subjectXmlForPartnerMerchantDisconnected() {\n    return `<partner-merchant>\n  <partner-merchant-id>abc123</partner-merchant-id>\n</partner-merchant>`;\n  }\n\n  subjectXmlForConnectedMerchantStatusTransitioned(id) {\n    return `<connected-merchant-status-transitioned>\n        <merchant-public-id>${id}</merchant-public-id>\n        <status>new_status</status>\n        <oauth-application-client-id>oauth_application_client_id</oauth-application-client-id>\n      </connected-merchant-status-transitioned>`;\n  }\n\n  subjectXmlForConnectedMerchantPayPalStatusChanged(id) {\n    return `<connected-merchant-paypal-status-changed>\n        <merchant-public-id>${id}</merchant-public-id>\n        <action>link</action>\n        <oauth-application-client-id>oauth_application_client_id</oauth-application-client-id>\n      </connected-merchant-paypal-status-changed>`;\n  }\n\n  subjectXmlForPartnerMerchantDeclined() {\n    return `<partner-merchant>\n  <partner-merchant-id>abc123</partner-merchant-id>\n</partner-merchant>`;\n  }\n\n  subjectXmlForOAuthAccessRevocation(id) {\n    return `<oauth-application-revocation>\n      <merchant-id>${id}</merchant-id>\n      <oauth-application-client-id>oauth_application_client_id</oauth-application-client-id>\n    </oauth-application-revocation>`;\n  }\n\n  subjectXmlForPaymentMethodRevokedByCustomer(id) {\n    return `<paypal-account>\n      <billing-agreement-id>a-billing-agreement-id</billing-agreement-id>\n      <created-at type=\"datetime\">2019-01-01T12:00:00Z</created-at>\n      <customer-id>a-customer-id</customer-id>\n      <default type=\"boolean\">true</default>\n      <email>name@email.com</email>\n      <global-id>cGF5bWVudG1ldGhvZF9jaDZieXNz</global-id>\n      <image-url>https://assets.braintreegateway.com/payment_method_logo/paypal.png?environment=test</image-url>\n      <subscriptions type=\"array\"/>\n      <token>${id}</token>\n      <updated-at type=\"datetime\">2019-01-02T12:00:00Z</updated-at>\n      <is-channel-initiated nil=\"true\"/>\n      <payer-id>a-payer-id</payer-id>\n      <payer-info nil=\"true\"/>\n      <limited-use-order-id nil=\"true\"/>\n      <revoked-at type=\"datetime\">2019-01-02T12:00:00Z</revoked-at>\n    </paypal-account>`;\n  }\n\n  subjectXmlForLocalPaymentCompleted() {\n    return `<local-payment>\n      <payment-id>a-payment-id</payment-id>\n      <payer-id>a-payer-id</payer-id>\n      <payment-method-nonce>ee257d98-de40-47e8-96b3-a6954ea7a9a4</payment-method-nonce>\n      <transaction>\n        <id>1</id>\n        <status>authorizing</status>\n        <amount>10.00</amount>\n        <order-id>order1234</order-id>\n      </transaction>\n    </local-payment>`;\n  }\n\n  subjectXmlForLocalPaymentExpired() {\n    return `<local-payment-expired>\n      <payment-id>a-payment-id</payment-id>\n      <payment-context-id>a-payment-context-id</payment-context-id>\n    </local-payment-expired>`;\n  }\n\n  subjectXmlForLocalPaymentFunded() {\n    return `<local-payment-funded>\n      <payment-id>a-payment-id</payment-id>\n      <payment-context-id>a-payment-context-id</payment-context-id>\n      <transaction>\n        <id>1</id>\n        <status>settled</status>\n        <amount>10.00</amount>\n        <order-id>order1234</order-id>\n      </transaction>\n    </local-payment-funded>`;\n  }\n\n  subjectXmlForLocalPaymentReversed() {\n    return `<local-payment-reversed>\n      <payment-id>a-payment-id</payment-id>\n    </local-payment-reversed>`;\n  }\n\n  subjectXmlForPaymentMethodCustomerDataUpdated(id) {\n    return `<payment-method-customer-data-updated-metadata>\n      <token>TOKEN-12345</token>\n      <payment-method>\n        ${this._venmoAccountXml(id)}\n      </payment-method>\n      <datetime-updated type='dateTime'>2022-01-01T21:28:37Z</datetime-updated>\n      <enriched-customer-data>\n        <fields-updated type='array'>\n          <item>username</item>\n        </fields-updated>\n        <profile-data>\n          <username>venmo_username</username>\n          <first-name>John</first-name>\n          <last-name>Doe</last-name>\n          <phone-number>1231231234</phone-number>\n          <email>john.doe@paypal.com</email>\n        </profile-data>\n      </enriched-customer-data>\n    </payment-method-customer-data-updated-metadata>`;\n  }\n\n  _venmoAccountXml(id) {\n    return `<venmo-account>\n      <default type=\"boolean\">true</default>\n      <image-url>https://assets.braintreegateway.com/payment_method_logo/venmo.png?environment=test</image-url>\n      <token>${id}</token>\n      <source-description>Venmo Account: venmojoe</source-description>\n      <username>venmojoe</username>\n      <venmo-user-id>456</venmo-user-id>\n      <subscriptions type=\"array\"/>\n      <customer-id>venmo_customer_id</customer-id>\n      <global-id>cGF5bWVudG1ldGhvZF92ZW5tb2FjY291bnQ</global-id>\n    </venmo-account>`;\n  }\n}\n\nmodule.exports = {\n  WebhookTestingGateway: wrapPrototype(WebhookTestingGateway),\n};\n"],"mappings":"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EAAE,EAAE;IACnC,OAAQ;AACZ,oBAAoBA,EAAG;AACvB;AACA;AACA;AACA;AACA,sBAAsB;EACpB;EAEAoF,+BAA+BA,CAACpF,EAAE,EAAE;IAClC,OAAQ;AACZ,QAAQA,EAAG;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;EACb;EAEAsF,0CAA0CA,CAACtF,EAAE,EAAE;IAC7C,OAAQ;AACZ,QAAQA,EAAG;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;EACb;EAEA2C,0BAA0BA,CAAC3C,EAAE,EAAE;IAC7B,OAAQ;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQA,EAAG;AACX;AACA,UAAUA,EAAG;AACb;AACA;AACA;AACA,WAAW;EACT;EAEAyC,wBAAwBA,CAACzC,EAAE,EAAE;IAC3B,OAAQ;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQA,EAAG;AACX;AACA,UAAUA,EAAG;AACb;AACA;AACA;AACA,WAAW;EACT;EAEA6C,uBAAuBA,CAAC7C,EAAE,EAAE;IAC1B,OAAQ;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQA,EAAG;AACX;AACA,UAAUA,EAAG;AACb;AACA;AACA;AACA;AACA,WAAW;EACT;EAEAiC,4BAA4BA,CAACjC,EAAE,EAAE;IAC/B,OAAQ;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQA,EAAG;AACX;AACA,UAAUA,EAAG;AACb;AACA;AACA;AACA,WAAW;EACT;EAEAmC,gCAAgCA,CAACnC,EAAE,EAAE;IACnC,OAAQ;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQA,EAAG;AACX;AACA,UAAUA,EAAG;AACb;AACA;AACA;AACA,WAAW;EACT;EAEAqC,4BAA4BA,CAACrC,EAAE,EAAE;IAC/B,OAAQ;AACZ;AACA;AACA;AACA;AACA;AACA;A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"},"metadata":{},"sourceType":"script","externalDependencies":[]}